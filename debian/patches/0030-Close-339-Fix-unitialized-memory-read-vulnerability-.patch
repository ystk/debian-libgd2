From: "Christoph M. Becker" <cmbecker69@gmx.de>
Date: Thu, 10 Aug 2017 18:31:29 +0200
Subject: Close #339: Fix unitialized memory read vulnerability in GIF reading
Origin: https://github.com/libgd/libgd/commit/c613bc169802bb4b639ee2e15c61b25b80a88424
Bug-Debian: https://bugs.debian.org/869263
Bug-Debian-Security: https://security-tracker.debian.org/tracker/CVE-2017-7890

The stack allocated color map buffers were not zeroed before usage, and
so undefined palette indexes could cause information leakage.

This issue has been reported by Matviy Kotoniy to security@libgd.org in
<CAKm_7a-AO++B6cXYWM_DtycPENG5WNWK7NSEvQ5OmZziMY_JyA@mail.gmail.com>.
---

--- a/src/gd_gif_in.c
+++ b/src/gd_gif_in.c
@@ -152,6 +152,9 @@ BGD_DECLARE(gdImagePtr) gdImageCreateFro
 
 	gdImagePtr im = 0;
 
+	memset(ColorMap, 0, 3 * MAXCOLORMAPSIZE);
+	memset(localColorMap, 0, 3 * MAXCOLORMAPSIZE);
+
 	if(!ReadOK(fd, buf, 6)) {
 		return 0;
 	}
